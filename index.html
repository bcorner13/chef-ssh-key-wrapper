<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Chef SSH Key Wrapper by vkhatri</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Chef SSH Key Wrapper</h1>
        <p>Chef cookbook LWRP to Manage SSH Key &amp; Wrapper</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/vkhatri/chef-ssh-key-wrapper" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/vkhatri/chef-ssh-key-wrapper/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/vkhatri/chef-ssh-key-wrapper/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a id="ssh_key_wrapper-cookbook" class="anchor" href="#ssh_key_wrapper-cookbook" aria-hidden="true"><span class="octicon octicon-link"></span></a>ssh_key_wrapper Cookbook</h1>

<p><a href="https://travis-ci.org/vkhatri/chef-ssh-key-wrapper"><img src="https://travis-ci.org/vkhatri/chef-ssh-key-wrapper.svg?branch=master" alt="Build Status"></a></p>

<p>This is a <a href="https://www.getchef.com/chef/">Chef</a> cookbook for Managing SSH Private Key file using Chef Data Bag and SSH Wrapper file (primarily for GIT).</p>

<p>All SSH Private Keys are stored in a Databag as a Databag item to maintain simplicity.</p>

<h2>
<a id="todo" class="anchor" href="#todo" aria-hidden="true"><span class="octicon octicon-link"></span></a>TODO</h2>

<ul>
<li>add LWRP resource <code>public</code> to manage <code>authorized_keys</code>
</li>
</ul>

<h2>
<a id="cookbook-recipes" class="anchor" href="#cookbook-recipes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cookbook Recipes</h2>

<ul>
<li><p>default   - not used</p></li>
<li><p>private_keys   - create LWRP <code>private_keys</code> resources using node attribute</p></li>
</ul>

<h2>
<a id="repository" class="anchor" href="#repository" aria-hidden="true"><span class="octicon octicon-link"></span></a>Repository</h2>

<p><a href="https://github.com/vkhatri/chef-ssh-key-wrapper">https://github.com/vkhatri/chef-ssh-key-wrapper</a></p>

<h2>
<a id="cookbook-lwrp" class="anchor" href="#cookbook-lwrp" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cookbook LWRP</h2>

<p><strong>LWRP - ssh_key_wrapper_private</strong></p>

<p>ssh_key_wrapper_private LWRP is used to manage ssh private key file as well as ssh wrapper file for the ssh private key.</p>

<p><strong>LWRP example</strong></p>

<p><em>via node attribute:</em></p>

<pre><code>"default_attributes": {
  "ssh_key_wrapper": {
    "private_keys": {
      "test": {
        "user": "foo",
        "group": "foo",
        "key_name": "databag item name",
        "enable_wrapper": true,
        "wrapper_file": "wrapper file path",
        "key_file" "ssh private key file path",
        "databag": "databag name",
        "action": "create"
      }
    }
  }
}
</code></pre>

<p><em>Create a RR using LWRP</em></p>

<pre><code>ssh_key_wrapper_private "foo" do
  option value ...
end
</code></pre>

<p><em>Delete a RR using LWRP</em></p>

<pre><code>ssh_key_wrapper_private "key name" do
  option value
  action :delete ...
end
</code></pre>

<p><strong>LWRP Options</strong></p>

<p>Parameters:</p>

<ul>
<li>
<em>key_name</em> - ssh private key file name, LWRP will lookup a data bag item with this attribute value</li>
<li>
<em>databag (default: <code>node['ssh_key_wrapper']['databag']</code>)</em> - data bag to read ssh private key file item</li>
<li>
<em>databag_secret (default: <code>node['ssh_key_wrapper']['databag_secret']</code>)</em> - encrypted data bag secret</li>
<li>
<em>cookbook (default: <code>node['ssh_key_wrapper']['wrapper']</code>)</em> - ssh wrapper file template cookbook</li>
<li>
<em>template (default: <code>node['ssh_key_wrapper']['template']</code>)</em> - ssh wrapper file template name</li>
<li>
<em>enable_wrapper (default: <code>node['ssh_key_wrapper']['enable_wrapper']</code>)</em> - whether to create ssh wrapper file</li>
<li>
<em>wrapper_file (default: <code>$HOME/.ssh/#{key_name}_wrapper</code>)</em> - ssh wrapper file path</li>
<li>
<em>key_file (default: <code>$HOME/.ssh/#{key_name}</code>)</em> - ssh private key file path</li>
<li>
<em>key_secret (default: <code>nil</code>)</em> - if provided, decrypt ssh private key databag item key content</li>
<li>
<em>user (default: <code>node['ssh_key_wrapper']['user']</code>)</em> - owner of ssh private key file</li>
<li><p><em>group (deault: <code>node['ssh_key_wrapper']['group']</code>)</em> - group of ssh private key file</p></li>
<li><p><em>manage_key_dir (deault: <code>node['ssh_key_wrapper']['manage_key_dir']</code>)</em> - whether to manage ssh private key file directory</p></li>
</ul>

<h2>
<a id="cookbook-core-attributes" class="anchor" href="#cookbook-core-attributes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cookbook Core Attributes</h2>

<ul>
<li>
<p><code>default[:ssh_key_wrapper][:databag]</code> (default: <code>ssh_key_wrapper</code>): data bag for ssh key content, each ssh key is a data bag item.</p>

<p>Note: ssh private key data bag item must have an attribute 'key' with ssh private key content</p>
</li>
<li><p><code>default['ssh_key_wrapper']['databag_secret']</code> (default: <code>ssh_key_wrapper</code>): encrypted data bag secret</p></li>
<li>
<code>default['ssh_key_wrapper']['cookbook']</code> (default: <code>ssh_key_wrapper</code>): cookbook for ssh wrapper file template</li>
<li>
<code>default['ssh_key_wrapper']['template']</code> (default: <code>wrapper.erb</code>): template name for ssh wrapper file</li>
<li>
<code>default['ssh_key_wrapper']['enable_wrapper']</code> (default: <code>true</code>): create ssh wrapper</li>
<li>
<code>default['ssh_key_wrapper']['user']</code> (default: <code>root</code>): default ssh key and wrapper file owner</li>
<li>
<code>default['ssh_key_wrapper']['group']</code> (default: <code>root</code>): default ssh key and wrapper file group</li>
<li>
<code>default['ssh_key_wrapper']['private_keys']</code> (default: <code>{}</code>): node attribute used by recipe <code>private_keys</code> to create lwrp <code>private</code> resources</li>
<li>
<code>default['ssh_key_wrapper']['manage_key_dir']</code> (default: <code>true</code>): manage ssh private key file directory</li>
</ul>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork the repository on Github</li>
<li>Create a named feature branch (like <code>add_component_x</code>)</li>
<li>Write your change</li>
<li>Write tests for your change (if applicable)</li>
<li>Run the tests (<code>rake</code>), ensuring they all pass</li>
<li>Write new resource/attribute description to <code>README.md</code>
</li>
<li>Write description about changes to PR</li>
<li>Submit a Pull Request using Github</li>
</ol>

<h2>
<a id="copyright--license" class="anchor" href="#copyright--license" aria-hidden="true"><span class="octicon octicon-link"></span></a>Copyright &amp; License</h2>

<p>Authors:: Virender Khatri and <a href="https://github.com/vkhatri/chef-ssh-key-wrapper/graphs/contributors">Contributors</a></p>

<pre>
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</pre>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/vkhatri">vkhatri</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
